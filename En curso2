package org.example;

import java.sql.*;

public class ConnectDB {
    private String dbq="sys";
    private String jdbc="jdbc:mysql://localhost:3306/"+dbq;
    private Connection connection;

    void connectDB(){
        try{
            connection=DriverManager.getConnection(jdbc,"root","root");
            System.out.println("Conexi贸n con la base de datos establecida");
        } catch (SQLException e) {
            System.out.println("Error de conexi贸n: "+e.getMessage());
        }
    }

    void closeConnection(){
        try{
            connection.close();
            System.out.println("Conexi贸n cerrada correctamente");
        } catch (SQLException e) {
            System.out.println("Error al cerrar conexi贸n:"+e.getMessage());
        }
    }

    ResultSet getSysInfo() {
        String sqlQuery= "SELECT * FROM sys_config;";
        ResultSet configuraciones=null;

        try{
            //Crear statement
            Statement statement =connection.createStatement();
            //Lanzar consulta de SQL
            configuraciones= statement.executeQuery(sqlQuery);
            System.out.println("Consulta "+sqlQuery+" ejecutada correctamente");
        } catch (SQLException e) {
            System.out.println("Error al ver la tabla: "+e.getMessage());
        }
        return configuraciones;
    }

    void showSysInfo(ResultSet configuraciones){
        try{
            System.out.printf("%-50s %-25s %-25s %-25s","variable","value","setTime","setBy");
            while (configuraciones.next()){
                String variable= configuraciones.getString("variable");
                String value= configuraciones.getString("value");
                Timestamp setTime = configuraciones.getTimestamp("set_time");
                String setBy= configuraciones.getString("set_by");
                System.out.printf("%-50s %-25s %-25s %-25s\n",variable,value,setTime,setBy);
            }
        } catch (SQLException e) {
            System.out.println("Error al mostrar la tabla: "+e.getMessage());
        }

    }

}
