package org.example;

import java.sql.*;

public class ConnectDB {
    private String dbq="sakila";
    private String jdbc="jdbc:mysql://localhost:3306/"+dbq;
    private Connection connection;

    void connectDB(){
        try{
            connection= DriverManager.getConnection(jdbc,"root","root");
            System.out.println("Conexi贸n con la base de datos establecida");
        } catch (SQLException e) {
            System.out.println("Error de conexi贸n: "+e.getMessage());
        }
    }

    void closeConnection(){
        try{
            connection.close();
            System.out.println("Conexi贸n cerrada correctamente");
        } catch (SQLException e) {
            System.out.println("Error al cerrar conexi贸n:"+e.getMessage());
        }
    }

    void getShowFilmInfo() {
        String sqlQuery= "SELECT * FROM film limit 50;";
        ResultSet films=null;

        try{
            //Crear statement
            Statement statement =connection.createStatement();
            //Lanzar consulta de SQL
            films= statement.executeQuery(sqlQuery);
            System.out.println("Consulta "+sqlQuery+" ejecutada correctamente");
        } catch (SQLException e) {
            System.out.println("Error al ver la tabla: "+e.getMessage());
        }
        //Mostrar la consulta
        try{
            System.out.printf("%-25s %-50s %-80s %-25s %-25s\n","film_id","title","description","release_year","language_id");
            while (films.next()){
                int film_id= films.getInt("film_id");
                String title= films.getString("title");
                String description = films.getString("description");
                int release_year= films.getInt("release_year");
                int language_id= films.getInt("language_id");
                System.out.printf("%-25s %-50s %-80s %-25s %-25s\n",film_id,title,description,release_year,language_id);
            }
        } catch (SQLException e) {
            System.out.println("Error al mostrar la tabla: "+e.getMessage());
        }
    }

    void getShowActorInfo() {
        String sqlQuery= "SELECT * FROM actor;";
        ResultSet actors=null;

        try{
            //Crear statement
            Statement statement =connection.createStatement();
            //Lanzar consulta de SQL
            actors= statement.executeQuery(sqlQuery);
            System.out.println("Consulta "+sqlQuery+" ejecutada correctamente");
        } catch (SQLException e) {
            System.out.println("Error al ver la tabla: "+e.getMessage());
        }
        //Mostrar la consulta
        try{
            System.out.printf("%-25s %-50s %-50s %-50s\n","actor_id","first_name","last_name","last_update");
            while (actors.next()){
                int actor_id= actors.getInt("actor_id");
                String first_name= actors.getString("first_name");
                String last_name = actors.getString("last_name");
                Timestamp last_update= actors.getTimestamp("last_update");
                System.out.printf("%-25s %-50s %-50s %-50s\n",actor_id,first_name,last_name,last_update);
            }
        } catch (SQLException e) {
            System.out.println("Error al mostrar la tabla: "+e.getMessage());
        }
    }

    ResultSet getFilmInfo() {
        String sqlQuery= "SELECT * FROM film;";
        ResultSet films=null;

        try{
            //Crear statement
            Statement statement =connection.createStatement();
            //Lanzar consulta de SQL
            films= statement.executeQuery(sqlQuery);
            System.out.println("Consulta "+sqlQuery+" ejecutada correctamente");
        } catch (SQLException e) {
            System.out.println("Error al ver la tabla: "+e.getMessage());
        }
        return films;
    }
    void showFilmInfo(ResultSet films){
        try{
            System.out.printf("%-25s %-50s %-80s %-25s %-25s\n","film_id","title","description","release_year","language_id");
            while (films.next()){
                int film_id= films.getInt("film_id");
                String title= films.getString("title");
                String description = films.getString("description");
                int release_year= films.getInt("release_year");
                int language_id= films.getInt("language_id");
                System.out.printf("%-25s %-50s %-80s %-25s %-25s\n",film_id,title,description,release_year,language_id);
            }
        } catch (SQLException e) {
            System.out.println("Error al mostrar la tabla: "+e.getMessage());
        }
    }


    ResultSet getActorInfo() {
        String sqlQuery= "SELECT * FROM actor;";
        ResultSet actors=null;

        try{
            //Crear statement
            Statement statement =connection.createStatement();
            //Lanzar consulta de SQL
            actors= statement.executeQuery(sqlQuery);
            System.out.println("Consulta "+sqlQuery+" ejecutada correctamente");
        } catch (SQLException e) {
            System.out.println("Error al ver la tabla: "+e.getMessage());
        }
        return actors;
    }
    void showActorInfo(ResultSet actors){
        try{
            System.out.printf("%-25s %-50s %-50s %-50s\n","actor_id","first_name","last_name","last_update");
            while (actors.next()){
                int actor_id= actors.getInt("actor_id");
                String first_name= actors.getString("first_name");
                String last_name = actors.getString("last_name");
                Timestamp last_update= actors.getTimestamp("last_update");
                System.out.printf("%-25s %-50s %-50s %-50s\n",actor_id,first_name,last_name,last_update);
            }
        } catch (SQLException e) {
            System.out.println("Error al mostrar la tabla: "+e.getMessage());
        }
    }






}
